<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.Donggle.CollaB.card.service.CardMapper">
	<select id="cardCheckListExist" resultType="int"
	parameterType="co.Donggle.CollaB.card.service.CardVO">
		SELECT COUNT(*) 
		FROM CHECKLIST 
		WHERE CARD_ID = #{card_id}
	</select>
	
	<select id="cardFileExist" resultType="int"
	parameterType="co.Donggle.CollaB.card.service.CardVO">
		SELECT COUNT(*) 
		FROM FILE_INFO 
		WHERE CARD_ID = #{card_id}
	</select>
	
	<select id="cardManagerProfIMG" resultType="string"
	parameterType="co.Donggle.CollaB.card.service.CardVO">
		SELECT U.PROF_PIC
		FROM USER_INFO U, CARD C
		WHERE U.ID = C.MANAGER
		AND CARD_ID = #{card_id}
	</select>
	
	<insert id="createCard"
	parameterType="co.Donggle.CollaB.card.service.CardVO">
		<selectKey keyProperty="card_id" resultType="int" order="BEFORE">
			SELECT MAX(CARD_ID)+1 FROM CARD
		</selectKey>
		INSERT INTO CARD(CARD_ID, CARD_TITLE, LIST_ID)
		VALUES(#{card_id},#{card_title},#{list_id})
	</insert>
	
	<select id="selectCurrentCard"
	resultType="co.Donggle.CollaB.card.service.CardVO">
		SELECT * 
		FROM CARD
		WHERE CARD_ID = (SELECT MAX(CARD_ID) 
						 FROM CARD)
	</select>
</mapper>